<div class="tagsafe-table">
  <div class='tagsafe-table-row header'>
    <div class="tagsafe-table-cell flex-3">Tag</div>
    <div class="tagsafe-table-cell">Average Response Time</div>
    <div class="tagsafe-table-cell">Max Response Time</div>
    <div class="tagsafe-table-cell"># Failed Requests</div>
    <div class="tagsafe-table-cell">Fail Rate</div>
    <div class='tagsafe-table-cell'></div>
  </div>
  <% tags.each do |tag| %>
    <div class='tagsafe-table-row'>
      <div class='tagsafe-table-cell flex-3'>
        <%= image_tag tag.try_image_url, class: 'tag-thumbnail border' %>
        <div class='d-block ms-3'>
          <span class='tag-row-header'><%= tag.try_friendly_name %></span>
          <% if tag.has_friendly_name? %>
            <span class='tag-row-sub-header'><%= tag.url_based_on_preferences %></span>
          <% end %>
        </div>
      </div>
      <div class='tagsafe-table-cell'>
        <% if tag.uptime_monitoring_enabled? %>
          <%= number_to_human(tag.average_response_time(days_ago: days_ago), units: { unit: 'ms', thousand: 'seconds' }) %>
        <% else %>
          <div class='tagsafe-pill small-text grey' data-controller='tooltip' data-bs-toggle='tooltip' title='Uptime monitoring is not enabled for this tag, you can manage your uptime settings in your tag settings.'>
            Disabled
          </div>
        <% end %>
      </div>
      <div class='tagsafe-table-cell'>
        <% if tag.uptime_monitoring_enabled? %>
          <%= number_to_human(tag.max_response_time(days_ago: days_ago), units: { unit: 'ms', thousand: 'seconds' }) %>
        <% else %>
          <div class='tagsafe-pill small-text grey' data-controller='tooltip' data-bs-toggle='tooltip' title='Uptime monitoring is not enabled for this tag, you can manage your uptime settings in your tag settings.'>
            Disabled
          </div>
        <% end %>
      </div>
      <div class='tagsafe-table-cell'>
        <% if tag.uptime_monitoring_enabled? %>
          <%= tag.num_failed_requests(days_ago: days_ago) %>
        <% else %>
          <div class='tagsafe-pill small-text grey' data-controller='tooltip' data-bs-toggle='tooltip' title='Uptime monitoring is not enabled for this tag, you can manage your uptime settings in your tag settings.'>
            Disabled
          </div>
        <% end %>
      </div>
      <div class='tagsafe-table-cell'>
        <% if tag.uptime_monitoring_enabled? %>
          <span data-controller='tooltip' data-bs-toggle='tooltip' title="<%= tag.num_failed_requests %> of the last <%= tag.total_num_of_requests %> have failed over the last 7 days.">
            <%= tag.fail_rate(days_ago: days_ago) %>%
          </span>
        <% else %>
          <div class='tagsafe-pill small-text grey' data-controller='tooltip' data-bs-toggle='tooltip' title='Uptime monitoring is not enabled for this tag, you can manage your uptime settings in your tag settings.'>
            Disabled
          </div>
        <% end %>
      </div>
      <div class='tagsafe-table-cell justify-content-end'>
        <div class="dropdown dropleft show ellipsis-dropdown tagsafe-circular-btn">
          <a class="dropdown-link" data-controller='dropdown' href="#" role="button" id="dropdownMenuLink" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <i class="fas fa-ellipsis-v" style="font-size: 18px;"></i>
          </a>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
            <%= link_to 'View Tag Uptime', uptime_tag_path(tag), class: 'dropdown-item' %> 
            <%= link_to 'View Tag Details', tag_path(tag), class: 'dropdown-item' %> 
          </div>
        </div>
      </div>
    </div>
  <% end %>
</div>

<%= paginate tags %>