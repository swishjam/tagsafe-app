<% unless @hide_navigation %>
  <div class='top-level-nav-bar d-flex align-items-center'>
    <div class='container-fluid'>
      <div class='row align-items-center'>
        <div class='col-8'>
          <% if @breadcrumbs && @breadcrumbs.any? %>
            <ol class="breadcrumb mb-0 p-0">
              <% @breadcrumbs.each do |crumb| %>
                <li class="breadcrumb-item <%= crumb[:active] ? 'active' : nil %>">
                  <% if crumb[:url] %>
                    <%= link_to crumb[:text], crumb[:url] %>
                  <% else %>
                    <%= crumb[:text] %>
                  <% end %>
                </li>
              <% end %>
            </ol>
          <% end %>
        </div>
        <div class='col-4 pe-4 d-flex align-items-center justify-content-end'>
          <div class="navigation-profile-dropdown-container dropdown-container w-fit">
            <div class='navigation-profile-trigger dropdown-display-container' data-controller='dropdown' data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-bs-offset="0,15">
              <div class='display-text'>
                <div class='domain-url-line'>
                  <% unless current_domain.nil? %>
                    <span class='domain-url'><%= current_domain.url %></span>
                  <% end %>
                  <% if user_is_anonymous? %>
                    <span class='dropdown-indicator'>
                      <i class="fa-solid fa-chevron-up"></i>
                    </span>
                  <% end %>
                </div>
                <% unless user_is_anonymous? %>
                  <div class='user-name-line'>
                    <span class='user-name'><%= current_user.full_name %></span>
                    <span class='dropdown-indicator d-inline'>
                      <i class="fa-solid fa-chevron-up"></i>
                    </span>
                  </div>
                <% end %>
              </div>
            </div>
            <div class="dropdown-menu dropdown-menu-end navigation-profile-dropdown-content p-3">
              <div class='dropdown-title text-center'>
                <% unless user_is_anonymous? %>
                  <span class='d-block'><%= current_user.full_name %></span>
                  <span class='d-block'><%= current_user.email %></span>
                <% end %>
                <% unless current_domain.nil? %>
                  <span class='d-block'><%= current_domain.url %></span>
                <% end %>
              </div>
              <% if !user_is_anonymous? && current_user.belongs_to_multiple_domains? %>
                <div class='dropdown-divider'></div>
                <% current_user.domains.each do |domain| %>
                  <div class='dropdown-item text-center <%= domain == current_domain ? 'active' : nil %>'>
                    <% if domain == current_domain %>
                      <%= domain.url %>
                    <% else %>
                      <%= form_with model: domain, url: update_current_domain_path(domain.uid), method: :put do |f| %>
                        <span data-controller='feaux_form_submit_button'><%= domain.url %></span>
                      <% end %>
                    <% end %>
                  </div>
                <% end %>
              <% end %>
              <div class='dropdown-divider'></div>
              <%= link_to 'Add New Domain', new_domain_path(additional: true), class: 'dropdown-item text-center no-decoration' %>
              <%= link_to 'Settings', settings_path, class: 'dropdown-item text-center no-decoration', target: '_top' %>
              <% unless user_is_anonymous? %>
                <%= link_to 'Billing', settings_billing_path, class: 'dropdown-item text-center no-decoration', target: '_top' %>
              <% end %>
              <%= link_to 'Help', '#', class: 'dropdown-item text-center no decoration', target: '_top' %>
              <div class='dropdown-divider'></div>
              <%= link_to 'Sign out', logout_path, class: 'dropdown-item text-center no-decoration', target: '_top' %>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
<% end %>