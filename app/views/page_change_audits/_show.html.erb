<%= turbo_frame_tag "audit_#{audit.uid}_page_change_audit" do %>
  <% if page_change_audit.tag_causes_page_changes %>    
    <div class='col-12'>
      <div class='row'>
        <div class='col-6'>
          <% if page_change_audit.absolute_additions > 0 %>
            <h5><span class='test-run-icon failed red-text'><i class='far fa-times-circle'></i></span> Caused <%= page_change_audit.absolute_additions %> additions to the page's HTML</h5>
          <% end %>
        </div>
        <div class='col-6'>
          <% if page_change_audit.absolute_deletions > 0 %>
            <h5><span class='test-run-icon failed red-text'><i class='far fa-times-circle'></i></span> Caused <%= page_change_audit.absolute_deletions %> deletions to the page's HTML</h5>
          <% end %>
        </div>
      </div>
    </div>
  <% else %>
    <h4><span class='test-run-icon passed green-text'><i class='far fa-check-circle'></i></span> Tag caused zero changes to the page's HTML</h4>
  <% end %>
  <div class='col-12 mb-2'>
    <div class='row'>
      <div class='col-6'>
        <h6>Page without tag</h6>
        <div class='simulated-browser'>
          <div class='full-screenable pointer full-height no-background d-flex align-items-center screenshot-wrapper' data-controller='full-screen-expandable' data-full-screen-expandable-target='expandable' data-action='click->full-screen-expandable#toggle'>
            <div class='shadow-background'></div>
            <%= image_tag page_change_audit.html_snapshot_without_tag.screenshot_s3_location, class: 'img-fluid' %>
          </div>
        </div>
      </div>
      <div class='col-6'>
        <h6>Page with tag</h6>
        <div class='simulated-browser'>
          <div class='full-screenable pointer full-height no-background d-flex align-items-center screenshot-wrapper' data-controller='full-screen-expandable' data-full-screen-expandable-target='expandable' data-action='click->full-screen-expandable#toggle'>
            <div class='shadow-background'></div>
            <%= image_tag page_change_audit.html_snapshot_with_tag.screenshot_s3_location, class: 'img-fluid' %>
          </div>
        </div>
      </div>
    </div>
  </div>
  <% if page_change_audit.tag_causes_page_changes %>    
    <style><%= Diffy::CSS %></style>
    <div class='col-12'>
      <div class='row git-diff-container'>
        <div class='col-6'>
          <% if page_change_audit.absolute_additions > 0 %>
            <h5><span class='test-run-icon failed red-text'><i class='far fa-times-circle'></i></span> Caused <%= page_change_audit.absolute_additions %> additions to the page's HTML</h5>
          <% end %>
          <div class='content'><%= additions_html.html_safe %></div>
        </div>
        <div class='col-6'>
          <% if page_change_audit.absolute_deletions > 0 %>
            <h5><span class='test-run-icon failed red-text'><i class='far fa-times-circle'></i></span> Caused <%= page_change_audit.absolute_deletions %> deletions to the page's HTML</h5>
          <% end %>
          <div class='content'><%= deletions_html.html_safe %></div>
        </div>
      </div>
    </div>
  <% end %>
<% end %>