<% content_for :head do %>
  <style><%= Diffy::CSS %></style>
<% end %>
<div class="row git-diff-container">
  <div class='tag-changes-container col-12 mb-3'>
    <div class='tag-details-tab'>
      <span><%= @tag_version.sha %></span>
    </div>
    <div class='tag-change-content p-3'>
      <div class='row'>
        <div class='col-6'>
          <span>Deployed <%= @tag_version.created_at.formatted_long %></span>
        </div>
        <div class='col-6 text-end'>
          <span><%= @tag_version.hashed_content %></span>
        </div>
      </div>
      <% if @tag_version.previous_version %>
        <span>The update previous to this was made on <%= @tag_version.previous_version.created_at.formatted_long %></span>
      <% end %>
    </div>
  </div>
  <%= turbo_frame_tag "#{@tag_version.id}_diff", src: diff_server_loadable_partials_tag_tag_version_path(@tag, @tag_version, diff_type: params[:diff_type]) do %>
    <div class='tag-changes-container col-12'>
      <div class='tag-details-tab'>
        <span><%= @tag.full_url %></span>
      </div>
      <div class='tag-change-content p-3'>
        <div class='row'>
          <% if params[:diff_type] == 'split' %>
            <div class="col-6">
              <%= render 'partials/utils/spinner', size: :small %>
            </div>
            <div class="col-6">
              <%= render 'partials/utils/spinner', size: :small %>
            </div>
          <% else %>
            <%= render 'partials/utils/spinner', size: :small %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>