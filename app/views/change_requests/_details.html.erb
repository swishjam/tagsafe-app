<%= turbo_frame_tag "#{tag_version.uid}_change_request_details" do %>
  <div class='px-10'>
    <div class="mt-5 grid grid-cols-1 divide-y divide-gray-200 md:grid-cols-3 md:divide-y-0 md:divide-x">
    
      <div class="px-4 py-5 sm:p-6 text-center">
        <div class="text-lg font-bold text-gray-900">Tagsafe Score</div>
        <div class="mt-1 flex items-baseline justify-center">
          <div class="flex space-x-4">
            <% if tag_version.primary_audit %>
              <% score = tag_version.primary_audit.tagsafe_score %>
              <span class='text-lg font-bold <%= score >= 90 ? 'text-green-700' : score >= 75 ? 'text-orange-700' : 'text-red-700' %>'>
                <%= score.round(2) %>
              </span>
            <% else %>
              <span class='text-lg text-gray-700'>
                No audits performed
              </span>
            <% end %>
            
            <% if tag_version.primary_audit && tag_version_to_compare_with&.primary_audit %>
              <span class='text-sm text-gray-500 flex items-center'>
                <% if tag_version.primary_audit.tagsafe_score > tag_version_to_compare_with.primary_audit.tagsafe_score %>
                  <span class='text-green-700'>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mr-1 inline">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941" />
                    </svg>
                    <%= tag_version.primary_audit.tagsafe_score - tag_version_to_compare_with.primary_audit.tagsafe_score %>
                  </span>
                <% else %>
                  <span class='text-red-700'>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mr-1 inline">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6L9 12.75l4.286-4.286a11.948 11.948 0 014.306 6.43l.776 2.898m0 0l3.182-5.511m-3.182 5.51l-5.511-3.181" />
                    </svg>
                    <%= tag_version.primary_audit.tagsafe_score - tag_version_to_compare_with.primary_audit.tagsafe_score %>
                  </span>
                <% end %> 
              </span>
            <% end %>

          </div>
        </div>
      </div>

      <div class="px-4 py-5 sm:p-6 text-center">
        <div class="text-lg font-bold text-gray-900">File size</div>
        <div class="mt-1 flex items-baseline justify-center">
          <div class="flex space-x-4">
            <span class='text-lg font-bold text-blue-700'><%= number_to_human_size(tag_version.bytes) %></span>
            <span class='text-sm flex items-center'>
              <% if tag_version.bytes > tag_version_to_compare_with.bytes %>
                <span class='text-red-700'>
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mr-1 inline">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941" />
                  </svg>
                  <%= number_to_human_size(tag_version.bytes - tag_version_to_compare_with.bytes) %>
                </span>
              <% else %>
                <span class='text-green-700'>
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 mr-1 inline">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6L9 12.75l4.286-4.286a11.948 11.948 0 014.306 6.43l.776 2.898m0 0l3.182-5.511m-3.182 5.51l-5.511-3.181" />
                  </svg>
                  <%= number_to_human_size(tag_version_to_compare_with.bytes - tag_version.bytes) %>
                </span>
              <% end %> 
            </span>
          </div>
        </div>
      </div>

      <div class="px-4 py-5 sm:p-6 text-center">
        <div class="text-lg font-bold text-gray-900">Requested at</div>
        <div class="mt-1 flex items-baseline justify-center">
          <span class='text-lg text-gray-700'>
            <%= time_ago_in_words(tag_version.captured_at) %> ago.
          </span>
        </div>
      </div>
    </div>
  </div>
<% end %>