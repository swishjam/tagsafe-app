<div class='page-title-container'>
  <div class='container-fluid'>
    <div class='row'>
      <div class='col-8'>
        <h1 class="page-title with-sub-title">Releases</h1>
        <h2 class='page-sub-title'></h2>
      </div>
      <div class='col-4 page-title-cta-container'>
        <%= modal_link select_tag_to_audit_tags_path, klass: 'page-title-cta-btn floating-btn tagsafe-purple-bg' do %>
          <div class='d-flex align-items-center'>
            Run Audit
            <span data-controller='hot-keys' data-action="modal" data-key-code='65' class='hot-key-indicator ms-1'>
              <form class='hidden' action="<%=select_tag_to_audit_tags_path%>" data-hot-keys-target='formAction' data-turbo-frame='server_loadable_modal'>
              </form>
              âŒ˜a
            </span>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

<%= turbo_frame_tag "#{current_domain.uid}_release_chart", src: release_chart_releases_path(all_tags: true) do %>
  <div class='tagsafe-container text-center p-5'>
    <%= display_loading_icon %>
  </div>
<% end %>

<div class='release-list-container'>
  <h4 class='mb-3'>Recent releases</h4>
  <% (0..2).each do |months_ago| %>
    <% start_date = Time.current.beginning_of_month - months_ago.months %>
    <% end_date = start_date.end_of_month %>
    <%= turbo_frame_tag "#{current_domain.uid}_release_list_for_#{start_date.month}-#{start_date.year}_to_#{end_date.month}-#{end_date.year}",
                          src: rolled_up_release_list_releases_path(all_tags: true, start_date: start_date, end_date: end_date) do %>
      <div class='release-list-month'>
        <div class='release-list-month-header'>
          <span class='header-text'>
            <%= start_date.beginning_of_month.strftime('%B, %Y') %>
            <%= display_loading_icon size: :tiny %>
          </span>
        </div>
      </div>
    <% end %>
  <% end %>
</div>