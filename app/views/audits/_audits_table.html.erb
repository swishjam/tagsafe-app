<%= turbo_frame_tag local_assigns[:domain] ? "domain_#{domain.uid}_audits_table" : "tag_version_#{tag_version.uid}_audits_table" do %>
  <div class='tagsafe-table'>
    <div class='tagsafe-table-head square'>
      <div class='tagsafe-table-row header'>
        <% if local_assigns[:include_tag_name] %>
          <div class='tagsafe-table-cell flex-3'>Audited Tag</div>
        <% end %>
        <div class='tagsafe-table-cell'>Date of Audit</div>
        <div class='tagsafe-table-cell'>Tagsafe Score</div>
        <div class='tagsafe-table-cell'>Tests Results</div>
        <div class='tagsafe-table-cell'>Performance Audited URL</div>
        <div class='tagsafe-table-cell'>Execution Reason</div>
      </div>
    </div>
    <div class='tagsafe-table-body'>
      <%= turbo_frame_tag local_assigns[:domain] ? "domain_#{domain.uid}_audits_table_rows" : "tag_version_#{tag_version.uid}_audits_table_rows" do %>
        <%= render partial: 'audits/audit_row', 
                    # collection: tag_version.audits.order(primary: :DESC).most_recent_first(timestamp_column: :enqueued_suite_at).includes(:performance_audits), 
                    collection: audits,
                    as: :audit, 
                    locals: { 
                      streamed: local_assigns[:streamed],
                      include_tag_name: local_assigns[:include_tag_name],
                      use_primary_indicator_insted_of_button: local_assigns[:include_tag_name]
                    } 
        %>
      <% end %>
    </div>
  </div>
  <%= paginate audits %>
  <% if audits.none? && local_assigns[:tag] %>
    <div class='mt-5'>
      <h4 class='mb-3'>No audits for this tag version, run one now?</h4>
      <%= link_to new_tag_audit_path(tag), class: 'tagsafe-btn', data: { controller: 'modal_trigger', } do %>
        <i class="fas fa-sync-alt"></i> Run audit
      <% end %>
    </div>
  <% end %>
<% end %>