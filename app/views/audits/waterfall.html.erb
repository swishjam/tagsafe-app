<%= render 'show_page_header', page_title: "Page Load Waterfall" %>

<% if !@audit.include_page_load_resources %>
  <div class='text-center p-5'>
    <h4>Page load waterfall breakdown was not enabled for this audit.</h4>
  </div>
<% elsif @audit.performance_audit_pending? %>
  <div class='text-center p-5'>
    <h4>Page load waterfall is running.</h4>
    <%= display_loading_spinner size: :large %>
  </div>
<% else %>
  <div class='tagsafe-container'>
    <h3 class='text-center'>Page load waterfall breakdown</h3>
    <div class='col-12 text-start'>
      <%= turbo_frame_tag 'page_load_resources_with_tag', src: tag_audit_page_load_resources_path(@tag, @audit, performance_audit_type: 'with_tag') do %>
        <div class='text-center'>
          <%= render 'partials/utils/spinner', size: :large %>
        </div>
      <% end %>
    </div>
    <div class='col-12 text-start mt-3'>
      <%= turbo_frame_tag 'page_load_resources_without_tag', src: tag_audit_page_load_resources_path(@tag, @audit, performance_audit_type: 'without_tag') do %>
        <div class='text-center'>
          <%= render 'partials/utils/spinner', size: :large %>
        </div>
      <% end %>
    </div>
  </div>
<% end %>